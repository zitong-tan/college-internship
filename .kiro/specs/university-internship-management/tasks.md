# 实施计划: 高校实习管理系统

## 概述

本实施计划将高校实习管理系统的设计转化为可执行的开发任务。系统使用 Vue 3 前端和 Node.js + Express 后端，采用 MySQL 数据库。任务按照增量开发的方式组织，每个任务都建立在前面的任务之上，确保系统逐步完善并可随时验证核心功能。

## 任务

- [x] 1. 搭建项目基础架构
  - 初始化后端项目（Node.js + Express）
  - 配置 Sequelize ORM 和 MySQL 连接
  - 设置前端项目结构（已有 Vue 3 基础）
  - 配置开发环境和构建工具
  - 创建统一的 API 响应格式
  - _需求: 10.1, 10.5_

- [x] 2. 实现数据库模型和迁移
  - [x] 2.1 创建用户相关表（users, students, teachers, enterprises）
    - 编写 Sequelize 模型定义
    - 创建数据库迁移脚本
    - 定义表关系和约束
    - _需求: 1.1, 1.5_

  - [ ]* 2.2 编写数据完整性约束属性测试
    - **属性 44: 数据完整性约束验证**
    - **验证: 需求 10.5**

  - [x] 2.3 创建岗位和申请相关表（positions, applications）
    - 编写模型定义和关联关系
    - 创建迁移脚本
    - _需求: 2.1, 4.1_

  - [ ]* 2.4 编写岗位和申请模型属性测试
    - **属性 6: 岗位创建完整性**
    - **属性 15: 申请创建关联正确**
    - **验证: 需求 2.1, 4.1**

  - [x] 2.5 创建实习记录相关表（internships, internship_logs, internship_files）
    - 编写模型定义
    - 创建迁移脚本
    - _需求: 5.4, 6.1, 6.2_

  - [x] 2.6 创建通知表（notifications）
    - 编写模型定义
    - 创建迁移脚本
    - _需求: 9.1_

- [x] 3. 实现用户认证系统
  - [x] 3.1 实现用户注册和密码加密
    - 使用 bcrypt 加密密码
    - 实现用户创建逻辑
    - _需求: 1.5_

  - [ ]* 3.2 编写密码加密属性测试
    - **属性 5: 密码加密存储**
    - **验证: 需求 1.5**

  - [x] 3.3 实现用户登录和 JWT 令牌生成
    - 验证用户凭据
    - 生成 JWT 令牌
    - 实现登录 API 端点
    - _需求: 1.1, 1.2_

  - [ ]* 3.4 编写认证属性测试
    - **属性 1: 有效凭据认证成功**
    - **属性 2: 无效凭据认证失败**
    - **验证: 需求 1.1, 1.2**

  - [x] 3.5 实现认证中间件和会话管理
    - JWT 令牌验证中间件
    - 会话超时检查
    - _需求: 1.4_

  - [ ]* 3.6 编写会话管理属性测试
    - **属性 4: 会话超时强制重新认证**
    - **验证: 需求 1.4**

  - [x] 3.7 实现基于角色的访问控制（RBAC）
    - 角色权限中间件
    - 路由权限配置
    - _需求: 1.3_

  - [ ]* 3.8 编写 RBAC 属性测试
    - **属性 3: 基于角色的访问控制**
    - **验证: 需求 1.3**

- [x] 4. 检查点 - 确保认证系统正常工作
  - 确保所有测试通过，如有问题请询问用户。

- [x] 5. 实现实习岗位管理功能
  - [x] 5.1 实现岗位 CRUD API
    - 创建岗位（POST /api/positions）
    - 获取岗位列表（GET /api/positions）
    - 获取岗位详情（GET /api/positions/:id）
    - 更新岗位（PUT /api/positions/:id）
    - 删除岗位（DELETE /api/positions/:id）
    - _需求: 2.1, 2.2, 2.3_

  - [ ]* 5.2 编写岗位管理属性测试
    - **属性 7: 岗位更新一致性**
    - **属性 8: 有申请的岗位不可删除**
    - **验证: 需求 2.2, 2.3**

  - [x] 5.3 实现岗位数据验证
    - 必填字段验证
    - 日期范围验证
    - 名额数量验证
    - _需求: 2.4_

  - [ ]* 5.4 编写岗位验证属性测试
    - **属性 9: 岗位数据验证**
    - **验证: 需求 2.4**

  - [x] 5.5 实现岗位状态自动更新逻辑
    - 名额为 0 时自动标记为已满
    - 过期岗位状态更新
    - _需求: 2.5, 3.5_

  - [ ]* 5.6 编写岗位状态属性测试
    - **属性 10: 岗位名额自动状态更新**
    - **属性 14: 已满或过期岗位状态标记**
    - **验证: 需求 2.5, 3.5**

  - [x] 5.7 实现岗位搜索和筛选功能
    - 关键词搜索（标题和描述）
    - 多条件筛选（企业、期限、类型）
    - 结果排序（按时间倒序）
    - _需求: 3.2, 3.3, 3.4_

  - [ ]* 5.8 编写搜索筛选属性测试
    - **属性 11: 搜索结果匹配关键词**
    - **属性 12: 筛选结果符合条件**
    - **属性 13: 岗位列表时间倒序排列**
    - **验证: 需求 3.2, 3.3, 3.4**

- [x] 6. 实现实习申请功能
  - [x] 6.1 实现申请提交 API
    - 创建申请记录
    - 关联学生和岗位
    - 数据验证
    - _需求: 4.1, 4.4_

  - [ ]* 6.2 编写申请提交属性测试
    - **属性 18: 申请数据完整性验证**
    - **验证: 需求 4.4**

  - [x] 6.3 实现申请业务规则验证
    - 检查重复申请
    - 检查岗位名额
    - _需求: 4.2, 4.3_

  - [ ]* 6.4 编写申请规则属性测试
    - **属性 16: 重复申请限制**
    - **属性 17: 已满岗位不可申请**
    - **验证: 需求 4.2, 4.3**

  - [x] 6.5 实现申请通知功能
    - 申请提交后通知教师
    - _需求: 4.5, 9.2_

  - [ ]* 6.6 编写申请通知属性测试
    - **属性 19: 申请提交触发通知**
    - **验证: 需求 4.5, 9.2**

  - [x] 6.7 实现申请审批 API
    - 批准申请（PUT /api/applications/:id/approve）
    - 拒绝申请（PUT /api/applications/:id/reject）
    - 记录审批信息
    - _需求: 5.2, 5.3, 5.5_

  - [ ]* 6.8 编写申请审批属性测试
    - **属性 20: 批准申请状态更新和通知**
    - **属性 21: 拒绝申请需要原因**
    - **属性 23: 审批记录完整性**
    - **验证: 需求 5.2, 5.3, 5.5**

  - [x] 6.9 实现批准后创建实习记录
    - 自动创建实习记录
    - 减少岗位可用名额
    - _需求: 5.4_

  - [ ]* 6.10 编写实习记录创建属性测试
    - **属性 22: 批准申请创建实习记录**
    - **验证: 需求 5.4**

- [ ] 7. 检查点 - 确保申请流程正常工作
  - 确保所有测试通过，如有问题请询问用户。

- [x] 8. 实现实习过程管理功能
  - [x] 8.1 实现实习日志功能
    - 提交日志 API（POST /api/internships/:id/logs）
    - 查看日志 API
    - 保存日志内容和时间
    - _需求: 6.1_

  - [ ]* 8.2 编写实习日志属性测试
    - **属性 24: 实习日志保存完整**
    - **验证: 需求 6.1**

  - [x] 8.3 实现文件上传功能
    - 文件上传 API（POST /api/internships/:id/files）
    - 文件格式和大小验证
    - 文件存储
    - _需求: 6.2_

  - [ ]* 8.4 编写文件上传属性测试
    - **属性 25: 文件上传验证**
    - **验证: 需求 6.2**

  - [x] 8.5 实现实习进度计算
    - 计算已完成天数
    - 显示进度百分比
    - _需求: 6.3_

  - [ ]* 8.6 编写进度计算属性测试
    - **属性 26: 实习进度计算正确**
    - **验证: 需求 6.3**

  - [x] 8.7 实现实习状态自动转换
    - 到期自动更新为待评价
    - 定时任务或触发器
    - _需求: 6.4_

  - [ ]* 8.8 编写状态转换属性测试
    - **属性 27: 实习到期自动状态转换**
    - **验证: 需求 6.4**

  - [x] 8.9 实现教师访问权限
    - 教师查看学生日志和文件
    - 权限验证
    - _需求: 6.5_

  - [ ]* 8.10 编写访问权限属性测试
    - **属性 28: 教师访问学生实习资料**
    - **验证: 需求 6.5**

- [x] 9. 实现实习评价功能
  - [x] 9.1 实现评价提交 API
    - 教师评价接口
    - 企业评价接口
    - 保存评价内容和评分
    - _需求: 7.1, 7.2_

  - [ ]* 9.2 编写评价保存属性测试
    - **属性 29: 评价保存完整性**
    - **验证: 需求 7.1, 7.2**

  - [x] 9.3 实现综合评分计算
    - 加权平均计算（教师 50% + 企业 50%）
    - 自动更新 final_score
    - _需求: 7.3_

  - [ ]* 9.4 编写评分计算属性测试
    - **属性 30: 综合评分计算正确**
    - **验证: 需求 7.3**

  - [x] 9.5 实现双方评价完成后状态更新
    - 检查双方评价是否都已提交
    - 更新实习状态为已完成
    - _需求: 7.4_

  - [ ]* 9.6 编写评价完成属性测试
    - **属性 31: 双方评价完成后状态更新**
    - **验证: 需求 7.4**

  - [x] 9.7 实现学生查看评价功能
    - 学生查看自己的评价 API
    - 权限验证
    - _需求: 7.5_

  - [ ]* 9.8 编写学生查看评价属性测试
    - **属性 32: 学生查看自己的评价**
    - **验证: 需求 7.5**

- [x] 10. 实现通知系统
  - [x] 10.1 实现通知创建和发送
    - 状态变更触发通知
    - 实习到期提醒
    - 通知存储
    - _需求: 9.1, 9.3_

  - [ ]* 10.2 编写通知触发属性测试
    - **属性 37: 状态变更触发通知**
    - **属性 38: 实习到期提醒**
    - **验证: 需求 9.1, 9.3**

  - [x] 10.3 实现通知查询和管理
    - 获取通知列表 API
    - 未读通知数量统计
    - 标记已读功能
    - _需求: 9.4, 9.5_

  - [ ]* 10.4 编写通知管理属性测试
    - **属性 39: 未读通知数量显示**
    - **属性 40: 查看通知标记已读**
    - **验证: 需求 9.4, 9.5**

- [x] 11. 实现统计和报表功能
  - [x] 11.1 实现统计数据查询
    - 按时间段统计
    - 企业岗位和学生分布统计
    - _需求: 8.2, 8.3_

  - [ ]* 11.2 编写统计查询属性测试
    - **属性 33: 统计数据按时间段聚合**
    - **属性 34: 企业统计数据准确性**
    - **验证: 需求 8.2, 8.3**

  - [x] 11.3 实现报表导出功能
    - PDF 导出
    - Excel 导出
    - _需求: 8.4_

  - [ ]* 11.4 编写报表导出属性测试
    - **属性 35: 报表导出格式正确**
    - **验证: 需求 8.4**

  - [x] 11.5 实现筛选条件响应式更新
    - 筛选条件变更时重新计算统计
    - _需求: 8.5_

  - [ ]* 11.6 编写筛选更新属性测试
    - **属性 36: 筛选条件变更更新统计**
    - **验证: 需求 8.5**

- [x] 12. 检查点 - 确保后端 API 完整可用
  - 确保所有测试通过，如有问题请询问用户。


- [x] 13. 实现前端路由和状态管理
  - [x] 13.1 配置 Vue Router
    - 定义路由结构
    - 实现路由守卫（认证检查）
    - 角色权限路由控制
    - _需求: 1.3_

  - [x] 13.2 配置 Vuex 状态管理
    - 创建 auth 模块（用户认证状态）
    - 创建 position 模块（岗位数据）
    - 创建 application 模块（申请数据）
    - 创建 notification 模块（通知数据）
    - _需求: 1.1, 2.1, 4.1, 9.1_

  - [x] 13.3 封装 Axios HTTP 客户端
    - 请求拦截器（添加认证令牌）
    - 响应拦截器（统一错误处理）
    - API 接口封装
    - _需求: 1.1, 1.4_

- [x] 14. 实现用户认证界面
  - [x] 14.1 创建登录页面组件
    - 登录表单
    - 表单验证
    - 错误提示
    - _需求: 1.1, 1.2_

  - [ ]* 14.2 编写登录组件单元测试
    - 测试表单验证
    - 测试登录成功/失败场景

  - [x] 14.3 实现用户信息显示和登出
    - Header 组件显示用户信息
    - 登出功能
    - _需求: 1.1_

- [x] 15. 实现学生端界面
  - [x] 15.1 创建岗位列表组件
    - 显示可用岗位
    - 搜索功能
    - 筛选功能
    - 分页
    - _需求: 3.1, 3.2, 3.3_

  - [ ]* 15.2 编写岗位列表单元测试
    - 测试列表渲染
    - 测试搜索功能
    - 测试筛选功能

  - [x] 15.3 创建岗位详情组件
    - 显示岗位完整信息
    - 申请按钮
    - _需求: 3.1_

  - [x] 15.4 创建申请表单组件
    - 个人简介输入
    - 联系方式输入
    - 表单验证
    - 提交申请
    - _需求: 4.1, 4.4_

  - [ ]* 15.5 编写申请表单单元测试
    - 测试表单验证
    - 测试提交功能

  - [x] 15.6 创建我的申请列表组件
    - 显示学生的所有申请
    - 申请状态显示
    - _需求: 4.1_

  - [x] 15.7 创建实习日志组件
    - 日志列表显示
    - 日志提交表单
    - _需求: 6.1_

  - [x] 15.8 创建文件上传组件
    - 文件选择
    - 上传进度
    - 文件列表
    - _需求: 6.2_

  - [x] 15.9 创建实习进度显示组件
    - 进度条
    - 已完成天数/总天数
    - _需求: 6.3_

  - [x] 15.10 创建评价查看组件
    - 显示教师评价
    - 显示企业评价
    - 显示综合评分
    - _需求: 7.5_

- [x] 16. 实现教师端界面
  - [x] 16.1 创建申请审批列表组件
    - 显示待审批申请
    - 筛选和搜索
    - _需求: 5.1_

  - [x] 16.2 创建申请审批详情组件
    - 显示申请详细信息
    - 批准按钮
    - 拒绝按钮和原因输入
    - _需求: 5.2, 5.3_

  - [ ]* 16.3 编写审批组件单元测试
    - 测试批准功能
    - 测试拒绝功能

  - [x] 16.4 创建学生监督组件
    - 查看学生实习列表
    - 查看实习日志
    - 查看上传文件
    - _需求: 6.5_

  - [x] 16.5 创建评价提交组件
    - 评分输入
    - 评语输入
    - 提交评价
    - _需求: 7.1_

  - [x] 16.6 创建统计报表组件
    - 统计数据展示（图表）
    - 时间段筛选
    - 报表导出
    - _需求: 8.1, 8.2, 8.4_

- [x] 17. 实现企业端界面
  - [x] 17.1 创建岗位管理列表组件
    - 显示企业的所有岗位
    - 创建岗位按钮
    - 编辑和删除按钮
    - _需求: 2.1, 2.2, 2.3_

  - [x] 17.2 创建岗位编辑表单组件
    - 岗位信息输入
    - 表单验证
    - 创建/更新岗位
    - _需求: 2.1, 2.2, 2.4_

  - [ ]* 17.3 编写岗位管理单元测试
    - 测试创建岗位
    - 测试编辑岗位
    - 测试删除岗位

  - [x] 17.4 创建实习生管理组件
    - 显示在本企业实习的学生
    - 查看学生信息
    - _需求: 5.4_

  - [x] 17.5 创建企业评价组件
    - 评分输入
    - 评语输入
    - 提交评价
    - _需求: 7.2_

- [x] 18. 实现通知系统界面
  - [x] 18.1 创建通知中心组件
    - 通知列表
    - 未读标记
    - 标记已读功能
    - _需求: 9.4, 9.5_

  - [x] 18.2 创建通知提示组件
    - Header 中显示未读数量
    - 实时通知弹窗
    - _需求: 9.4_

  - [ ]* 18.3 编写通知组件单元测试
    - 测试通知显示
    - 测试标记已读

- [x] 19. 实现错误处理和用户体验优化
  - [x] 19.1 实现统一错误处理
    - 错误拦截器
    - 友好的错误提示
    - 错误日志记录
    - _需求: 所有需求_

  - [x] 19.2 实现加载状态和骨架屏
    - Loading 组件
    - 骨架屏组件
    - 异步操作加载提示
    - _需求: 所有需求_

  - [x] 19.3 实现表单验证和提示
    - 实时验证
    - 错误提示
    - 成功提示
    - _需求: 2.4, 4.4_

- [x] 20. 实现数据持久化和事务处理
  - [x] 20.1 实现数据库事务处理
    - 关键操作使用事务
    - 失败自动回滚
    - _需求: 10.3_

  - [ ]* 20.2 编写事务处理属性测试
    - **属性 42: 数据库操作失败回滚**
    - **验证: 需求 10.3**

  - [x] 20.3 实现操作日志记录
    - 记录关键操作
    - 日志存储
    - _需求: 10.4_

  - [ ]* 20.4 编写日志记录属性测试
    - **属性 43: 关键操作日志记录**
    - **验证: 需求 10.4**

  - [x] 20.5 实现数据持久化验证
    - 确保操作后数据立即保存
    - _需求: 10.1_

  - [ ]* 20.6 编写数据持久化属性测试
    - **属性 41: 数据操作立即持久化**
    - **验证: 需求 10.1**

- [ ] 21. 集成测试和端到端测试
  - [ ]* 21.1 编写完整申请流程集成测试
    - 学生申请 → 教师审批 → 创建实习记录
    - _需求: 4.1, 5.2, 5.4_

  - [ ]* 21.2 编写完整评价流程集成测试
    - 教师评价 → 企业评价 → 计算综合评分 → 状态更新
    - _需求: 7.1, 7.2, 7.3, 7.4_

  - [ ]* 21.3 编写通知系统集成测试
    - 操作触发 → 通知创建 → 用户接收 → 标记已读
    - _需求: 9.1, 9.4, 9.5_

- [x] 22. 最终检查点 - 系统完整性验证
  - 确保所有测试通过
  - 验证所有功能正常工作
  - 检查用户体验
  - 如有问题请询问用户

- [x] 23. 部署准备和文档
  - [x] 23.1 编写 API 文档
    - 所有端点的文档
    - 请求/响应示例
    - 错误代码说明

  - [x] 23.2 编写部署文档
    - 环境配置说明
    - 数据库初始化步骤
    - 部署流程

  - [x] 23.3 编写用户手册
    - 学生使用指南
    - 教师使用指南
    - 企业使用指南

## 注意事项

- 标记为 `*` 的任务是可选的，可以跳过以加快 MVP 开发
- 每个任务都引用了具体的需求以便追溯
- 检查点确保增量验证
- 属性测试验证通用正确性属性
- 单元测试验证特定示例和边缘情况
